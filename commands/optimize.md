---
description: "성능 최적화 분석 및 개선"
allowed-tools: ["Read", "Grep", "Edit", "Bash"]
---

브랜치명, PR 번호, 또는 파일 경로를 기반으로 성능 최적화 분석을 진행합니다.

## 사용법:
- `/optimize branch-name` - 특정 브랜치와 main 브랜치 간 변경사항 최적화 분석
- `/optimize PR번호` - 특정 PR의 변경사항 최적화 분석 (gh CLI 필요)
- `/optimize PR번호 --comment` - 최적화 분석 후 자동으로 댓글 등록
- `/optimize file/path.ts` - 특정 파일 최적화 분석
- `/optimize` - 현재 브랜치의 변경사항 최적화 분석

## 최적화 분석 관점:

1. **데이터베이스 쿼리**: N+1 문제, 인덱스 최적화, 불필요한 쿼리 제거
2. **메모리 사용**: 메모리 누수, 효율적 메모리 사용, 가비지 컬렉션 최적화
3. **알고리즘**: 시간 복잡도 개선, 불필요한 반복문 제거
4. **캐싱**: Redis 캐싱 전략, 메모리 캐싱, 응답 캐싱
5. **비동기 처리**: Promise, async/await 최적화, 병렬 처리
6. **NestJS 특화**: 모듈 로딩, 의존성 주입, 미들웨어 최적화
7. **Prisma 최적화**: 쿼리 최적화, 관계 로딩, 트랜잭션 처리

## 자동 분석 프로세스:

먼저 인자를 분석하여 최적화 대상을 결정합니다:

- 숫자인 경우: PR 번호로 간주하여 `gh pr view`와 `gh pr diff` 사용
- 숫자 + `--comment` 플래그: 최적화 분석 후 `gh pr comment` 명령으로 댓글 자동 등록
- 브랜치명인 경우: `git diff main..브랜치명` 사용
- 파일 경로인 경우: 해당 파일을 직접 읽어서 분석
- 인자가 없는 경우: `git diff main..HEAD` 사용

변경된 파일들을 읽어서 상세한 성능 최적화 분석을 제공하고, 구체적인 개선 코드를 제안합니다.

## PR 댓글 기능:

`--comment` 플래그를 사용하면 분석 완료 후 자동으로 다음을 실행:
```bash
gh pr comment {PR번호} --body "최적화분석내용"
```

댓글은 다음 형식으로 작성됩니다:
- 🚀 성능 최적화 분석 개요
- 📊 현재 코드 성능 분석
- ⚡ 최적화 개선사항
- 💡 구체적인 코드 개선안
- 📈 예상 성능 향상 효과
- 🎯 우선순위별 적용 권장사항


---

$ARGUMENTS